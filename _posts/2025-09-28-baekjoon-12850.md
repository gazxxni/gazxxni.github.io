---
layout: post
title: "[백준] 12850번 (Python)"
date: 2025-09-28
categories: [Algorithm, Baekjoon]
tags: [python, algorithm, baekjoon, "12850"]
---

## 문제 링크
[https://www.acmicpc.net/problem/12850](https://www.acmicpc.net/problem/12850)

---

## 풀이

### 풀이 핵심 로직
주어진 문제는 그래프의 상태 전이를 통해 특정 시점에 가능한 상태의 수를 계산하는 것입니다. 이 문제는 그래프를 인접 행렬로 표현하고, 행렬의 거듭제곱을 통해 d 단계 후의 상태를 계산함으로써 해결됩니다. 행렬의 곱셈을 통해 연결된 상태의 수를 업데이트하고, 이를 재귀적으로 반복하여 d 단계의 상태를 구합니다.

### 동작 과정
1. **입력**: d를 입력받습니다. 이는 이동할 단계 수를 나타냅니다.
2. **그래프 정의**: 8개의 노드(상태)와 그들 간의 연결을 나타내는 인접 행렬 `graph`가 정의되어 있습니다.
3. **행렬 곱셈 함수**: `multiply(A, B)` 함수를 통해 두 개의 8x8 행렬 A와 B를 곱하고, 모듈로 연산을 통해 결과를 유지합니다.
4. **행렬 거듭제곱 함수**: `cal(A, n)` 함수는 재귀적으로 행렬 A를 n번 거듭제곱합니다. n이 1일 때는 A를 반환하고, n이 짝수일 경우 A를 반으로 나눈 결과를 곱하여 결과를 반환합니다. n이 홀수일 경우, 반으로 나눈 결과의 제곱에 A를 한 번 더 곱합니다.
5. **결과 출력**: 최종적으로 구한 행렬의 (0,0) 요소가 d 단계 후의 상태 수를 나타내므로 이를 출력합니다.

예를 들어, d가 2라면:
- `cal(graph, 2)`가 호출되어 `graph`의 2제곱을 계산합니다.
- `multiply` 함수는 `graph`와 `graph`를 곱하여 2단계 후의 상태를 계산합니다.
- 최종적으로 `result[0][0]`이 출력되며, 이는 2단계 후 가능한 상태의 수를 의미합니다.

### 시간 복잡도
행렬 곱셈의 시간 복잡도는 O(n^3)이며, 여기서 n은 행렬의 크기(이 경우 8)입니다. 행렬의 거듭제곱을 계산할 때는 log(d)의 깊이의 재귀 호출이 발생하므로 전체 시간 복잡도는 O(log(d) * n^3)입니다. 따라서 이 문제의 시간 복잡도는 O(log(d) * 8^3)으로, 이는 O(log(d))에 비례하는 상수 시간 복잡도로 간주할 수 있습니다.

---

## 코드
```python
import sys
input = sys.stdin.readline

MOD = 1_000_000_007

graph = [
    [0,1,1,0,0,0,0,0],
    [1,0,1,1,0,0,0,0],
    [1,1,0,1,1,0,0,0],
    [0,1,1,0,1,1,0,0],
    [0,0,1,1,0,1,0,1],
    [0,0,0,1,1,0,1,0],
    [0,0,0,0,0,1,0,1],
    [0,0,0,0,1,0,1,0],
]

d = int(input().strip())

def multiply(A, B):
    result = [[0] * 8 for i in range(8)]
  
    for i in range(8):
        for j in range(8):
            for k in range(8):
                result[i][j] += A[i][k] * B[k][j]
            result[i][j] %= MOD
      
    return result

def cal(A, n):
    if n == 1:
        return A
    cal2 = cal(A, n//2)
    
    if n % 2 == 0:
        return multiply(cal2, cal2)
    else:
        mul2 = multiply(cal2, cal2)
        return multiply(mul2, A)
    
result = cal(graph, d)
print(result[0][0])
```